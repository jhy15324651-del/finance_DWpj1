<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ê²Œì‹œê¸€ ë³µêµ¬</title>
</head>
<body>

<!-- 1ï¸âƒ£ head: header-main ì‚¬ìš© -->
<th:block th:replace="content/layout/header-main :: header-main"></th:block>

<!-- 2ï¸âƒ£ ê³µí†µ ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
<th:block th:replace="content/layout/header-main :: bodyheader"></th:block>

<div class="write-container">
    <h2>ì‚­ì œëœ ê²Œì‹œê¸€ ë³µêµ¬</h2>

    <!-- ğŸ”¥ ì´ í˜ì´ì§€ì—ì„œëŠ” ë‚´ìš©ì€ ê·¸ëƒ¥ ë³´ì—¬ì£¼ê¸°ìš©ì´ê³ 
         submit ì‹œì—ëŠ” /content/restore/{id} ë¡œë§Œ POST ë©ë‹ˆë‹¤ -->
    <form class="write-form"
          th:action="@{/content/restore/{id}(id=${post.id})}"
          method="post">

        <!-- ì œëª© -->
        <label>ì œëª©</label>
        <input type="text" name="title" th:value="${post.title}" readonly>

        <!-- Quill CSS -->
        <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

        <!-- ë³¸ë¬¸ (Quill Editor) -->
        <label>ë³¸ë¬¸</label>
        <div id="editor-container" style="height: 400px;"></div>

        <!-- ì„œë²„ë¡œ ë³´ë‚¼ ë³¸ë¬¸(ì‚¬ì‹¤ restore ì—ì„œ ì“°ì§€ëŠ” ì•ŠìŒ) -->
        <input type="hidden" id="content-hidden" name="content">

        <!-- í•´ì‹œíƒœê·¸ -->
        <label>í•´ì‹œíƒœê·¸</label>
        <input type="text" name="hashtags"
               th:value="${post.hashtags}"
               placeholder="#ì›ìœ  #ì—”ë¹„ë””ì•„ #ê²½ì œ"
               readonly>

        <!-- ğŸ”¹ ë²„íŠ¼: ë³µêµ¬ / ëŒì•„ê°€ê¸° ONLY -->
        <div style="text-align:center; margin-top:20px;">
            <!-- ê²Œì‹œê¸€ ë³µêµ¬í•˜ê¸°: /content/restore/{id} ë¡œ POST -->
            <button type="submit" class="btn-submit">ê²Œì‹œê¸€ ë³µêµ¬í•˜ê¸°</button>

            <!-- ëŒì•„ê°€ê¸°: ë‚´ ê²Œì‹œê¸€ ëª©ë¡ -->
            <a th:href="@{/user/mypage/posts}" class="btn-cancel">ëŒì•„ê°€ê¸°</a>
        </div>

    </form>
</div>

<!-- Quill JS -->
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<script th:inline="javascript">
    // ê¸°ì¡´ ë³¸ë¬¸ HTML
    var originalHtml = /*[[${post.content}]]*/ "";

    var toolbarOptions = [
        ['bold', 'italic', 'underline'],
        [{ 'header': 1 }, { 'header': 2 }],
        ['image']
    ];

    var quill = new Quill('#editor-container', {
        theme: 'snow',
        placeholder: 'ë‚´ìš©ì„ í™•ì¸í•˜ì„¸ìš”...',
        modules: {
            toolbar: toolbarOptions
        },
        readOnly: true   // ğŸ”¥ ë³µêµ¬ í˜ì´ì§€ì´ë¯€ë¡œ ì½ê¸° ì „ìš©
    });

    // ê¸°ì¡´ ë‚´ìš© ì±„ìš°ê¸°
    var delta = quill.clipboard.convert(originalHtml);
    quill.setContents(delta, 'silent');

    // (restore ì—ì„œëŠ” ì‚¬ì‹¤ í•„ìš” ì—†ì§€ë§Œ, í¼ êµ¬ì¡° ì¬ì‚¬ìš©ì„ ìœ„í•´ ë‚¨ê²¨ë‘ )
    document.querySelector(".write-form").addEventListener("submit", function () {
        document.querySelector("#content-hidden").value = quill.root.innerHTML;
    });
</script>

<style>
    .btn-submit {
        display: inline-block;
        padding: 8px 18px;
        background-color: #4caf50;
        color: white;
        border-radius: 6px;
        font-size: 14px;
        border: none;
        cursor: pointer;
    }
    .btn-submit:hover {
        background-color: #3e8e41;
    }

    .btn-cancel {
        display: inline-block;
        padding: 8px 18px;
        background-color: #888;
        color: white;
        border-radius: 6px;
        font-size: 14px;
        text-decoration: none;
        margin-left: 10px;
    }
</style>

<th:block th:replace="content/layout/footer :: footer"></th:block>

</body>
</html>
